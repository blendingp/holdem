<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="Sample">

	<typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap" />
	<typeAlias alias="searchVO" type="egovframework.example.sample.service.SampleDefaultVO" />


	<select id="selectMainFileYoutube" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from main_file
        	where kind = 'Y'
        ]]>
	</select>
	
	<insert id="insertMainFile" parameterClass="EgovMap">
        <![CDATA[
        	insert into main_file (originNm , saveNm , kind , orderNum , regDate)
        	values (#originNm# , #saveNm# , #kind# ,#orderNum# , now()) 
        ]]>
	</insert>
	
	<update id="updateMainFile" parameterClass="EgovMap">
        <![CDATA[
        	update main_file
        	set originNm = #originNm#,
        		saveNm = #saveNm# ,
        		kind = #kind#,
        		orderNum = #orderNum#,
        		regDate = now()
        	where idx = #idx#
        ]]>
	</update>

	<update id="updateMainFileImage" parameterClass="EgovMap">
        <![CDATA[
        	update main_file
        	set originNm = #originNm#,
        		saveNm = #saveNm# ,
        		kind = #kind#,
        		orderNum = #orderNum#
        	where idx = #idx#
        ]]>
	</update>

	<select id="selectMainFileImage" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from main_file
        	where kind = 'I'
        	order by regDate desc
        ]]>
	</select>
	
	<select id="selectMainFileImageUser" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from main_file
        	where kind = 'I'
        	order by orderNum , regDate desc
        ]]>
	</select>
	
	<select id="selectMainFileImageCnt" resultClass="int">
		<![CDATA[
			select count(*) num
			from main_file
			where kind='I'
		]]>
	</select>
	
	<delete id="deleteMainFileImageLimit">
		<![CDATA[
			delete from main_file
			where kind='I'
			order by regDate
			limit #limit#
		]]>
	</delete>
	
	<delete id="deleteMainFileImage">
		<![CDATA[
			delete from main_file
			where idx = #idx#
		]]>
	</delete>
	
	<select id="selectMainFileDetail" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from main_file
        	where idx = #idx#
        ]]>
	</select>
	
	<update id="updateMainFileImageOrderNum" parameterClass="egovMap">
        <![CDATA[
        	update main_file
        	set	orderNum = #orderNum#
        	where idx = #idx#
        ]]>
	</update>
	
	<insert id="insertInquiry" parameterClass="egovMap">
		<![CDATA[
			insert into inquiry (title , text , pw , regDate , answerYn , delYn)
			values (#title# , #text# , #pw# , now() , 'N' , 'N')
		]]>
	</insert>
	
	<insert id="insertNotice" parameterClass="egovMap">
		<![CDATA[
			insert into notice (title , text , expsYn , topYn , delYn , regDate)
			values (#title# , #text# , #expsYn# , #topYn# , 'N' , now())
		]]>
	</insert>
	
	<insert id="updateNotice" parameterClass="egovMap">
		<![CDATA[
			update notice 
			set title = #title#,
				text = #text#,
				expsYn = #expsYn#,
				topYn = #topYn#
			where idx = #idx#
		]]>
	</insert>
	
	<select id="selectNoticeAdmin" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from notice
        	where delYn = 'N'
        	order by regDate desc
        	limit #firstindex#, #recordperpage#
        ]]>
	</select>
	<select id="selectNoticeAdminCnt" resultClass="int">
        <![CDATA[
        	select count(*) 
        	from notice
        	where delYn = 'N'
        ]]>
	</select>
	<select id="selectNoticeUserCnt" resultClass="int">
        <![CDATA[
        	select count(*) 
        	from notice
        	where delYn = 'N' and expsYn = 'Y'
        		and idx not in (
        ]]>
        		<isNotEmpty property="excludeIdx0">
        			#excludeIdx0#
        		</isNotEmpty>
        		<isNotEmpty property="excludeIdx1">
        			,#excludeIdx1#
        		</isNotEmpty>
        		<isNotEmpty property="excludeIdx2">
        			,#excludeIdx2#
        		</isNotEmpty>
        <![CDATA[
        		)
        ]]>
	</select>
	
	<select id="selectNoticeUser" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from notice
        	where delYn = 'N'and expsYn='Y'
        		and idx not in (
        ]]>
        		<isNotEmpty property="excludeIdx0">
        			#excludeIdx0#
        		</isNotEmpty>
        		<isNotEmpty property="excludeIdx1">
        			,#excludeIdx1#
        		</isNotEmpty>
        		<isNotEmpty property="excludeIdx2">
        			,#excludeIdx2#
        		</isNotEmpty>
        <![CDATA[
        		
        		)
        	order by regDate desc
        	limit #firstindex#, #recordperpage#
        ]]>
	</select>
		
	<update id="deleteNotice" parameterClass="egovMap">
        <![CDATA[
        	update notice
        	set	delYn = 'Y'
        	where idx = #idx#
        ]]>
	</update>
	
	<select id="selectNoticeDetail" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from notice
        	where idx = #idx#
        ]]>
	</select>
	
	<update id="noticeViewCnt">
		<![CDATA[
			update notice set
			viewCnt = viewCnt + 1
			where idx=#idx#
		]]>
	</update>
	
	<select id="selectInquiryDetail" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from inquiry
        	where idx = #idx#
        ]]>
	</select>
	
	<select id="selectInquiry" resultClass="EgovMap">
        <![CDATA[
        	select * 
        	from inquiry
        	where delYn = 'N'
        	order by regDate desc
        	limit #firstindex#, #recordperpage#
        ]]>
	</select>
		
	<select id="selectInquiryCnt" resultClass="int">
        <![CDATA[
        	select count(*) 
        	from inquiry
        	where delYn = 'N'
        ]]>
	</select>
		
	<update id="deleteInquiry" parameterClass="egovMap">
        <![CDATA[
        	update inquiry
        	set delYn = 'Y'
        	where idx = #idx#
        ]]>
	</update>
	
	<update id="insertAnswer" parameterClass="egovMap">
        <![CDATA[
        	update inquiry
        	set answer = #answer#,
        		answerYn= 'Y',
        		answerDate = now()
        	where idx = #idx#
        ]]>
	</update>
	
	<select id="selectEtcBoardByKind" resultClass="egovMap">
        <![CDATA[
        	select * 
        	from etc_board
        	where kind = #kind#
        ]]>
	</select>
	
	<insert id="insertEtcBoard" parameterClass="egovMap">
        <![CDATA[
        	insert into etc_board (text , kind , regDate , updtDate)
        	values(#text# , #kind# , now() , now())
        ]]>
	</insert>
	
	<update id="updateEtcBoard" parameterClass="egovMap">
        <![CDATA[
        	update etc_board
        	set text = #text#,
        		kind = #kind#,
        		updtDate = now()
        	where idx = #idx#
        ]]>
	</update>
	
	<select id="game" resultClass="egovMap">
		<![CDATA[
			select *
			from etc_board
			where kind='G'			
		]]>
	</select>
	
	<select id="provision" resultClass="egovMap">
		<![CDATA[
			select *
			from etc_board
			where kind='P'			
		]]>
	</select>
	
	<select id="pwChk" resultClass="egovMap">
		<![CDATA[
			select *
			from inquiry
			where idx=#idx#
		]]>
	</select>
	
	<update id="inquiryUpdate">
		<![CDATA[
			update inquiry set
				title=#title#,
				text=#text#
			where idx=#idx#
		]]>
	</update>
	
	<update id="inquiryDel">
		<![CDATA[
			update inquiry set
				delYn='Y'
			where idx=#idx#
		]]>
	</update>
	
	<select id="selectNoticeUserTop" resultClass="egovMap">
		<![CDATA[
			select *
			from notice
			where topYn='Y' and delYn='N' and expsYn='Y'
			order by regDate desc
			limit 3
		]]>
	</select>
	
</sqlMap>
